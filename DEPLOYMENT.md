# Production Deployment Guide for Laravel Forge

This documentation provides instructions for deploying the **Website Status Monitoring System** to a Laravel Forge production environment.

## Pre-Deployment Requirements

- Active [Laravel Forge](https://forge.laravel.com) subscription.
- A configured Forge server instance (Ubuntu OS, Nginx web server, PHP 8.2 or newer, MySQL database, Redis cache).
- Git repository access configured.

## Step 1: Site Creation

1.  Access your Forge server dashboard.
2.  Create a **New Site**:
    *   **Domain Name**: Example: `monitor.yourdomain.com`
    *   **Framework**: Select `Laravel`
    *   **PHP Version**: Choose `PHP 8.2` or newer (Minimum requirement: `^8.2`)
3.  **Connect Git Repository**:
    *   Source: GitLab, GitHub, or your preferred provider
    *   Repository Path: `r.arijit23/web-uptime-monitor`
    *   Branch: `main`
    *   Click **Install Repository** to proceed.

## Step 2: Environment Variables Configuration

Forge automatically generates a `.env` configuration file. Update it with the following production settings.

1.  Navigate to the **Environment** section.
2.  Configure these environment variables:

```ini
APP_NAME="Website Status Monitoring System"
APP_ENV=production
APP_KEY=base64:... (Auto-generated by Forge)
APP_DEBUG=false
APP_URL=https://monitor.yourdomain.com

# Database Configuration (Auto-populated by Forge)
DB_CONNECTION=mysql
DB_HOST=127.0.0.1
DB_PORT=3306
DB_DATABASE=forge
DB_USERNAME=forge
DB_PASSWORD=...

# Cache and Queue Settings (Redis recommended)
CACHE_STORE=redis
QUEUE_CONNECTION=redis
SESSION_DRIVER=redis

# Redis Configuration (Auto-populated by Forge)
REDIS_HOST=127.0.0.1
REDIS_PASSWORD=...
REDIS_PORT=6379

# Email Service Configuration (Mailgun recommended for production)
MAIL_MAILER=mailgun
MAIL_HOST=smtp.mailgun.org
MAIL_PORT=587
MAIL_USERNAME=...
MAIL_PASSWORD=...
MAIL_ENCRYPTION=tls
MAIL_FROM_ADDRESS=hello@example.com
MAILGUN_DOMAIN=...
MAILGUN_SECRET=...
```

3.  Save the configuration by clicking **Save**.

## Step 3: Deployment Script Configuration

The deployment process must install dependencies, run database migrations, and compile frontend assets.

1.  Open the **App** or **Deployments** section.
2.  Modify the **Deployment Script** with the following:

```bash
cd /home/forge/monitor.yourdomain.com
git pull origin $FORGE_SITE_BRANCH

$FORGE_COMPOSER install --no-interaction --prefer-dist --optimize-autoloader

( flock -w 10 9 || exit 1
    echo 'Restarting FPM...'; sudo -S service $FORGE_PHP_FPM reload ) 9>/tmp/fpmlock

if [ -f artisan ]; then
    $FORGE_PHP artisan migrate --force
fi

# Frontend Asset Compilation
npm ci
npm run build

# Performance Optimization (Recommended)
$FORGE_PHP artisan config:cache
$FORGE_PHP artisan route:cache
$FORGE_PHP artisan view:cache
```

3.  Save changes by clicking **Update Deployment Script**.

## Step 4: Background Job Processor Setup

The system relies on background job processing (e.g., `CheckWebsiteStatus` job class). Configure a queue worker to handle these tasks.

1.  Access the **Queue** section from the server dashboard sidebar.
2.  Create a **New Worker**:
    *   **Queue Connection**: `redis`
    *   **Queue Name**: `default`
    *   **PHP Version**: `PHP 8.2`
    *   **Run as Daemon**: Enable this option
3.  Activate the worker by clicking **Start Worker**.

## Step 5: Scheduled Task Configuration

The application utilizes Laravel's task scheduler for automated periodic status checks.

1.  Navigate to the **Scheduler** section in the server dashboard sidebar.
2.  Add a **New Scheduled Job**:
    *   **Command**: `php artisan schedule:run`
    *   **System User**: `forge`
    *   **Execution Frequency**: `Every Minute`
3.  Confirm by clicking **Schedule Job**.

## Step 6: Post-Deployment Testing

-   **Initial Deployment**: Trigger a deployment by clicking **Deploy Now**.
-   **Error Logging**: Review application logs at `storage/logs/laravel.log` if any issues occur.
-   **Functionality Verification**: Register a test website for monitoring and confirm status updates appear within a few minutes (validates Queue and Scheduler functionality).
